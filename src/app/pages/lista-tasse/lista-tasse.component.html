<div class="main-area" xmlns="http://www.w3.org/1999/html">
  <main>
    <ngx-spinner [fullScreen]="true" [zIndex]="50" bdColor="rgba(255, 255, 255, 0.8)" color="#118ab2"
                 size="medium" type="square-jelly-box">
      <p style="color: #118ab2"> Caricamento... </p>
    </ngx-spinner>
    <div class="title-with-button">

      <div class="child2" *ngIf="showList">
        <i class="pi pi-money-bill"></i> <span> Lista corsi</span>
      </div>
      <div class="child2" *ngIf="!showList">
         <span>Corso: {{corsoSelected.name}}</span>
      </div>

      <div class="child">
        <button *ngIf="showList"
                class="p-button-primary p-button-raised p-button" icon="pi pi-plus" label="Nuova tassa"
                pButton type="button"></button>
        <button *ngIf="!showList"
                class="p-button-warning p-button-raised p-button" icon="pi pi-arrow-left" label="Torna alla lista" (click)="showList=true"
                pButton type="button"></button>
      </div>


    </div>
    <div  class="card" @fadeInAnimation *ngIf="showList">
      <p-table

        *ngIf="corsi.length!==0"

        [paginator]="true"
        [rowsPerPageOptions]="[10,20,30]" [rows]="10" [showCurrentPageReport]="true"
        [totalRecords]="corsi.length"
        [value]="corsi"
        currentPageReportTemplate="Risultati da {first} a {last}. Totale {totalRecords}"
        responsiveLayout="scroll | stack"
      >
        <ng-template let-columns pTemplate="header">
          <tr>
            <th class="text-center">Nome Corso</th>
            <th class="text-center">Inizio corso</th>
            <th class="text-center">Fine corso</th>
            <th class="text-center">Studenti</th>
            <th class="text-center">Situazione Tasse mese corrente</th>
            <th class="text-center">Azioni</th>
          </tr>
        </ng-template>
        <ng-template let-columns="columns" let-practice pTemplate="body">
          <tr *ngIf="practice.tasse.length>0">
            <td class="text-center click">{{ practice.name }}</td>
            <td class="text-center click">{{ practice.dataInizio | date:'dd/MM/yyyy' }}</td>
            <td class="text-center click">{{ practice.dataFine | date:'dd/MM/yyyy'}}</td>
            <td class="text-center click">{{ practice.utentiArray.length}}</td>
            <td class="text-center click"><p-tag [style]="{'width': '50%'}"
                                                 [value]="practice.semaforo.message"
                                                 [severity]="getSemaforoColor(practice.semaforo.id)"></p-tag></td>

            <td class="text-center">
              <button class="p-button p-button-text p-button-lg" icon="pi pi-eye" pButton type="button" (click)="selectCorso(practice)"
              ></button>
              <button class="p-button p-button-danger p-button-text p-button-lg" icon="pi pi-trash" pButton
                      type="button"
              ></button>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <div  class="card" @fadeInAnimation *ngIf="!showList">
      <p-table

        *ngIf="corsoSelected.utentiArray.length!==0"

        [paginator]="true"
        [rowsPerPageOptions]="[10,20,30]" [rows]="10" [showCurrentPageReport]="true"
        [totalRecords]="corsoSelected.utentiArray.length"
        [value]="corsoSelected!.utentiArray"
        currentPageReportTemplate="Risultati da {first} a {last}. Totale {totalRecords}"
        responsiveLayout="scroll | stack"
      >

        <ng-template let-columns pTemplate="header">
          <tr>
            <th class="text-center">Nome e cognome</th>
            <th class="text-center">Email</th>
            <th class="text-center">Prossima tassa</th>
            <th class="text-center">Scadenza</th>
            <th class="text-center">Situazione tasse mese corrente</th>
            <th class="text-center">Paga</th>
            <th class="text-center">Azioni</th>
          </tr>
        </ng-template>
        <ng-template let-columns="columns" let-user pTemplate="body">
         <tr >
            <td class="text-center click">{{ user.name }} {{ user.surname }}</td>
            <td class="text-center click">{{ user.email  }}</td>
            <td class="text-center click">{{ user.tassaMeseCorrente.tassa  }}</td>
            <td class="text-center click">{{ user.tassaMeseCorrente.scadenza | date:'dd/MM/yyyy'}}</td>
            <td class="text-center click"><p-badge [style]="{'width': '70%'}"
              [value]="user.tassaMeseCorrente.stato==1 ? 'Da pagare':'Regolare'"
                                                 [severity]="user.tassaMeseCorrente.stato==1 ? 'danger':'success'"></p-badge>



           <td class="text-center">
           <div [pTooltip]="(user.tassaMeseCorrente.stato==1 ? 'Spunta come pagato':'Tassa pagata')" style="display:inline-block;" tooltipPosition="top">
             <button [class]="(user.tassaMeseCorrente.stato==2 ? 'p-button-success':'p-button-danger')" class="p-button p-button-text p-button-lg"
                     icon="pi pi-check-circle" pButton type="button"  [disabled]="user.tassaMeseCorrente.stato==2"
             ></button>
           </div>
           </td>
           <td class="text-center">
             <button class="p-button p-button-text p-button-lg" icon="pi pi-money-bill" pButton type="button"  (click)="showHideInformation(user) "
             ></button>
             <div [pTooltip]="((user.tassaMeseCorrente.stato==1 && !user.tassaMeseCorrente.notificaPagamento)? 'Invia notifica di pagamento':'Notifica di pagamento inviata')"
                  style="display:inline-block;" tooltipPosition="top">
             <button *ngIf="user.tassaMeseCorrente.stato==1" icon="pi pi-envelope" pButton

                     type="button" [disabled]="(user.tassaMeseCorrente.stato==1 && user.tassaMeseCorrente.notificaPagamento)"
                     [class]="((user.tassaMeseCorrente.stato==1 && !user.tassaMeseCorrente.notificaPagamento)? 'p-button-danger':'p-button-success')" class="p-button p-button-text p-button-lg"
             ></button>
             </div>
             <button  *ngIf="user.tassaMeseCorrente.stato==2"
               icon="pi pi-envelope" pButton
                      type="button" [disabled]="true"
                      class="p-button p-button-text p-button-lg"
             ></button>
           </td>
          </tr>

        </ng-template>
      </p-table>
    </div>
  </main>
</div>
